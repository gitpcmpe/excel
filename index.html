<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Excel/CSV Viewer & Editor</title>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<style>
:root{
  --bg:#f5f7fb; --card:#ffffff; --accent:#4f46e5; --muted:#6b7280;
}
body{font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; background:linear-gradient(180deg,var(--bg),#eef2ff); margin:0;padding:28px;color:#0f172a}
.container{max-width:1100px;margin:0 auto}
header{display:flex;align-items:center;gap:16px;margin-bottom:20px}
h1{font-size:20px;margin:0}
.subtitle{color:var(--muted);font-size:13px}

.card{background:var(--card);border-radius:12px;padding:16px;box-shadow:0 6px 18px rgba(15,23,42,0.06);margin-bottom:16px}
.row{display:flex;gap:12px;align-items:center; flex-wrap:wrap;}
.col{display:flex;flex-direction:column;gap:8px}

.file-area{display:flex;gap:12px;align-items:center; flex-wrap:wrap;}
.btn{background:var(--accent);color:white;padding:10px 14px;border-radius:10px;border:0;cursor:pointer;font-weight:600}
.btn.ghost{background:transparent;color:var(--accent);border:1px solid rgba(79,70,229,0.12)}
input[type=file]{display:none}
.file-list{max-height:120px;overflow:auto;padding:8px;border-radius:8px;border:1px dashed rgba(15,23,42,0.06);background:#fbfbff; display:flex; flex-wrap:wrap; gap:6px;}
.file-item{padding:6px 10px;border-radius:8px;background:linear-gradient(180deg,#fff,#fbfbff);display:flex;align-items:center; cursor:pointer; font-size:14px; width:48%;}
.file-item.active{outline:2px solid rgba(79,70,229,0.12)}

.toolbar{display:flex;gap:8px;align-items:center}
.icon-btn{background:#f8fafc;border-radius:8px;padding:8px;border:1px solid rgba(15,23,42,0.03);cursor:pointer}

.grid-wrap{margin-top:12px;border-radius:10px;border:1px solid rgba(15,23,42,0.04);overflow:auto;background:linear-gradient(180deg,#fff,#fcfcff)}
table.grid{border-collapse:collapse;width:100%;font-size:13px}
table.grid th, table.grid td{border:1px solid rgba(15,23,42,0.06);padding:4px 6px;min-width:40px;white-space:nowrap}
table.grid th{background:#fbfbff;font-weight:700; cursor:pointer}

.small{font-size:12px}
.muted{color:var(--muted)}

.cmd-area{display:flex;gap:8px; margin-top:4px;}
input.cmd{flex:1;padding:10px;border-radius:10px;border:1px solid rgba(15,23,42,0.06)}

footer{margin-top:16px;color:var(--muted);font-size:12px;text-align:center}

@media (max-width:880px){.row{flex-direction:column;align-items:stretch}}
</style>
</head>
<body>
<div class="container">
<header>
  <div style="width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--accent),#7c3aed);display:flex;align-items:center;justify-content:center;color:white;font-weight:700">XL</div>
  <div>
      <h1>Excel / CSV / Text Viewer & Editor</h1>
      <div class="subtitle">
      Excel(.xlsx/.xls), CSV, í…ìŠ¤íŠ¸(.txt/.doc/.docx) íŒŒì¼ì„ ë¹ ë¥´ê²Œ ì—´ì–´ë³´ê³  í¸ì§‘, ì°¾ê¸°/ë°”ê¾¸ê¸°, ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      </div>
  </div>
</header>

<section class="card">
  <div class="row file-area">
    <label class="btn" id="pickBtn">íŒŒì¼ ì„ íƒ</label>
    <input id="fileInput" type="file" accept=".csv,.xlsx,.xls,.txt,.doc,.docx" multiple />
    <div class="file-list" id="fileList" aria-live="polite"></div>
  </div>
</section>

<section class="card">
  <div class="row">
    <button class="btn" style="pointer-events:none; width:100%;">Command</button>
  </div>
  <div class="row">
    <div class="cmd-area">
      <input id="cmdInput" class="cmd" placeholder="ì˜ˆ: replace old -> new ë˜ëŠ” find:value ë˜ëŠ” ìì—°ì–´ ëª…ë ¹ì–´" />
      <button class="btn ghost" id="cmdRun">ì‹¤í–‰</button>
    </div>
  </div>
</section>

<section class="card">
  <div class="row" style="justify-content:flex-start; align-items:center; gap:12px; margin-bottom:8px;">
    <button class="btn" style="pointer-events:none;">Output</button>
    <div class="toolbar">
      <button class="icon-btn" id="fontDec" title="ê¸€ì ì‘ê²Œ">A-</button>
      <button class="icon-btn" id="fontInc" title="ê¸€ì í¬ê²Œ">A+</button>
      <button class="icon-btn" id="findBtn" title="ì°¾ê¸°">ğŸ”</button>
      <button class="icon-btn" id="replaceBtn" title="ë°”ê¾¸ê¸°">ğŸª„</button>
      <button class="icon-btn" id="undoBtn" title="ë˜ëŒë¦¬ê¸°">â¤º</button>
      <button class="icon-btn" id="downloadBtn" title="ë‹¤ìš´ë¡œë“œ">â¬‡ï¸</button>
      <button class="icon-btn" id="resetBtn" title="ì´ˆê¸°í™”">ğŸ”</button>
    </div>
  </div>
  <div id="resultArea" class="grid-wrap" style="max-height:560px"></div>
</section>

<footer class="muted">ì‘ë™: íŒŒì¼ ì„ íƒ â†’ í™œì„±í™” â†’ ë„êµ¬ ì‚¬ìš© ë˜ëŠ” ëª…ë ¹ì–´ ì‹¤í–‰. (ê¸°ë³¸ í¸ì§‘ ê°€ëŠ¥)</footer>
</div>

<script>
document.addEventListener('DOMContentLoaded',()=>{
const filesData=[]; let activeId=null; let fileCounter=0;
const fileInput=document.getElementById('fileInput');
const pickBtn=document.getElementById('pickBtn');
const fileList=document.getElementById('fileList');
const resultArea=document.getElementById('resultArea');
const cmdInput=document.getElementById('cmdInput');

pickBtn.addEventListener('click',()=>fileInput.click());
fileInput.addEventListener('change',(e)=>{
  const list=Array.from(e.target.files||[]);
  if(!list.length) return;
  list.forEach(file=>{
    if(filesData.some(f=>f.name===file.name)) return;
    const id=++fileCounter;
    const reader=new FileReader();
    reader.onload=(ev)=>{
      let workbook;
      try{
        if(file.name.endsWith('.csv')) workbook=XLSX.read(ev.target.result,{type:'string'});
        else workbook=XLSX.read(new Uint8Array(ev.target.result),{type:'array'});
      }catch(err){ alert("íŒŒì¼ ì½ê¸° ì˜¤ë¥˜: "+file.name); return; }
      const sheet=workbook.Sheets[workbook.SheetNames[0]];
      const json=XLSX.utils.sheet_to_json(sheet,{header:1,raw:false});
      filesData.push({id,name:file.name,rows:json,history:[JSON.stringify(json)],fontSize:13,editable:true});
      renderFileList();
      if(filesData.length===1) setActive(filesData[0].id);
    };
    if(file.name.endsWith('.csv')) reader.readAsText(file,'utf-8'); else reader.readAsArrayBuffer(file);
  });
  fileInput.value='';
});

function renderFileList(){
  fileList.innerHTML='';
  filesData.forEach((f,i)=>{
    const div=document.createElement('div');
    div.className='file-item'+(f.id===activeId?' active':'');
    div.textContent=`file#${i+1} ${f.name}`;
    div.addEventListener('click',()=>setActive(f.id));
    fileList.appendChild(div);
  });
}

function setActive(id){ activeId=id; renderFileList(); renderGrid(); }
function renderGrid(){
  resultArea.innerHTML='';
  const f=filesData.find(x=>x.id===activeId);
  if(!f){ resultArea.innerHTML='<div class="muted" style="padding:16px">í™œì„±í™”ëœ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.</div>'; return; }
  const table=document.createElement('table'); table.className='grid';
  const rows=f.rows; const cols=rows.reduce((m,r)=>Math.max(m,r.length||0),0);
  const thead=document.createElement('thead'); const htr=document.createElement('tr');
  const thIndex=document.createElement('th'); thIndex.textContent='#'; htr.appendChild(thIndex);
  for(let c=0;c<cols;c++){ const th=document.createElement('th'); th.textContent=String.fromCharCode(65+c); htr.appendChild(th); }
  thead.appendChild(htr); table.appendChild(thead);
  const tbody=document.createElement('tbody');
  rows.forEach((r,ri)=>{
    const tr=document.createElement('tr');
    const tdIndex=document.createElement('td'); tdIndex.textContent=ri+1; tdIndex.style.fontWeight='600'; tr.appendChild(tdIndex);
    for(let c=0;c<cols;c++){
      const td=document.createElement('td'); td.textContent=r[c]??''; td.contentEditable=f.editable;
      td.addEventListener('input',()=>{ f.rows[ri][c]=td.textContent; });
      tr.appendChild(td);
    }
    tbody.appendChild(tr);
  });
  table.appendChild(tbody);
  table.style.fontSize=f.fontSize+'px';
  resultArea.appendChild(table);
}
});
</script>
</body>
</html>
